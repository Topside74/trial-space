<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examination Portal</title>
    <link rel="shortcut icon" href="./ahia_logo-removebg-preview.png" type="image/x-icon">
    <style>
        :root {
            --primary-color: #1a237e;
            --secondary-color: #283593;
            --accent-color: #5c6bc0;
            --light-bg: #f5f7ff;
            --text-dark: #333;
            --text-light: #fff;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            --transition: all 0.3s ease;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-bg);
            color: var(--text-dark);
            line-height: 1.6;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: var(--text-light);
            text-align: center;
            padding: 30px 20px;
            box-shadow: var(--box-shadow);
        }
        
        header h1 {
            font-size: 2.5rem;
            letter-spacing: 1px;
        }
        
        nav {
            background-color: var(--secondary-color);
            padding: 15px 10px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        nav a {
            color: var(--text-light);
            text-decoration: none;
            margin: 0 15px;
            font-weight: 600;
            padding: 8px 15px;
            border-radius: 20px;
            transition: var(--transition);
        }
        
        nav a:hover {
            background-color: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }
        
        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 25px;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .section {
            margin-bottom: 40px;
            padding: 20px;
            border-radius: var(--border-radius);
            background-color: #fff;
            transition: var(--transition);
        }
        
        .section:hover {
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        
        .section h2 {
            color: var(--primary-color);
            border-bottom: 3px solid var(--accent-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .notification, .timetable, .results-form {
            margin: 20px 0;
            padding: 15px;
            background-color: #f0f4ff;
            border-left: 5px solid var(--accent-color);
            border-radius: 4px;
            transition: var(--transition);
        }
        
        .notification:hover, .timetable:hover, .results-form:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .notification a, .timetable a, .results-form a {
            color: var(--secondary-color);
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
        }
        
        .notification a:hover, .timetable a:hover, .results-form a:hover {
            color: var(--primary-color);
            text-decoration: underline;
        }
        
        /* Results Section Styling */
        #results {
            background: linear-gradient(to bottom, #ffffff, #f8f9ff);
            border: 1px solid #e8eaf6;
        }
        
        .results-form {
            background-color: #fff;
            padding: 25px;
            border-radius: var(--border-radius);
            border-left: 5px solid var(--accent-color);
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary-color);
            font-size: 1.1rem;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .form-group input:focus {
            border-color: var(--accent-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(92,107,192,0.2);
        }
        
        .form-group button {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            transition: var(--transition);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .form-group button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .form-group button:active {
            transform: translateY(1px);
        }
        
        #resultOutput {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px dashed #e0e0e0;
        }
        
        #resultOutput h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.6rem;
        }
        
        .result-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 20px;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        .result-table th, .result-table td {
            padding: 15px;
            text-align: left;
            border: 1px solid #e0e0e0;
        }
        
        .result-table th {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.9rem;
            letter-spacing: 1px;
        }
        
        .result-table tr:nth-child(even) {
            background-color: #f8f9ff;
        }
        
        .result-table tr:hover {
            background-color: #f0f4ff;
        }
        
        .download-btn {
            margin-top: 20px;
            background: linear-gradient(135deg, #2e7d32, #1b5e20);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            transition: var(--transition);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: block;
        }
        
        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            background: linear-gradient(135deg, #388e3c, #2e7d32);
        }
        
        .notice {
            color: #e53935;
            font-style: italic;
            margin-top: 15px;
            padding: 10px;
            background-color: #ffebee;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            position: relative;
            width: 100%;
            margin-top: 50px;
        }
        
        footer p {
            font-size: 0.9rem;
            letter-spacing: 0.5px;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
                margin: 15px;
            }
            
            nav {
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            nav a {
                margin: 5px;
                padding: 6px 12px;
            }
            
            .section {
                padding: 15px;
            }
            
            .form-group button, .download-btn {
                width: 100%;
            }
            
            .result-table th, .result-table td {
                padding: 10px;
            }
        }
    </style>
    <!-- Include jsPDF library and AutoTable plugin -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
    <header>
        <h1>Examination Portal</h1>
    </header>
    <nav>
        <a href="./index.html">Home</a>
        <a href="#degree">Degree Exam</a>
        <a href="#secondary">Secondary Exams</a>
        <a href="#senior-secondary">Senior Secondary Exams</a>
        <a href="#results">Results</a>
    </nav>
    <div class="container">
        <div class="section" id="degree">
            <h2>3-Year Degree Exam - Arabic Literature</h2>
            <div class="notification">
                <p>Notification dated 02:03 PM IST, June 30, 2025: Hall tickets for Degree I, III, and V Semesters Public Examinations (Sep 2025) are now published. <a href="#">Click here to download</a>.</p>
            </div>
            <div class="timetable">
                <p>Timetable for Degree Annual Examinations, February 2025 published. <a href="#">View Timetable</a>.</p>
                <p>Degree Ramadan Semester Exam March 2025 Results published. <a href="#">Check Results</a>.</p>
            </div>
        </div>

        <div class="section" id="secondary">
            <h2>Secondary Exams (1st to 5th Year - Final Year)</h2>
            <div class="notification">
                <p>Notification dated 02:03 PM IST, June 30, 2025: Viva for Secondary Final Year (5th Year) students will be conducted on December 29-31, 2025 at affiliated colleges.</p>
            </div>
            <div class="timetable">
                <p>Timetable for Secondary Half Yearly Examination Aug-Sep 2025 published. <a href="#">View Timetable</a>.</p>
                <p>Secondary 1st to 5th Year Annual Examinations, February 2025 schedule available. <a href="#">View Schedule</a>.</p>
            </div>
        </div>

        <div class="section" id="senior-secondary">
            <h2>Senior Secondary Exams (1st to 7th Year - Final Year)</h2>
            <div class="notification">
                <p>Notification dated 02:03 PM IST, June 30, 2025: Viva for Senior Secondary Final Year (7th Year) students will be conducted on December 29-31, 2025 at UG colleges.</p>
            </div>
            <div class="timetable">
                <p>Timetable for Senior Secondary Half Yearly Examination Aug-Sep 2025 published. <a href="#">View Timetable</a>.</p>
                <p>Senior Secondary 1st to 7th Year Annual Examinations, February 2025 schedule available. <a href="#">View Schedule</a>.</p>
            </div>
        </div>

        <div class="section" id="results">
            <h2>Check Your Results</h2>
            <div class="results-form">
                <div class="form-group">
                    <label for="regno">Enter Exam Registration Number:</label>
                    <input type="text" id="regno" name="regno" placeholder="e.g., DHIA/2025/001" required>
                </div>
                <div class="form-group">
                    <button onclick="displayResult()">Get Results</button>
                </div>
                <div id="resultOutput">
                    <h2>Result Details</h2>
                    <table class="result-table" id="resultTable" style="display: none;">
                        <thead>
                            <tr>
                                <th>Exam Type</th>
                                <th>Semester/Year</th>
                                <th>Subject</th>
                                <th>Marks</th>
                                <th>Grade</th>
                            </tr>
                        </thead>
                        <tbody id="resultBody">
                            <!-- Results will be populated here via JavaScript -->
                        </tbody>
                    </table>
                    <button id="downloadBtn" class="download-btn" style="display: none;" onclick="downloadResults()">Download Result Details</button>
                    <p class="notice" id="notice">Results available up to 02:03 PM IST, June 30, 2025. Check back later for updates.</p>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <p>© 2025 Examination Board. All rights reserved.</p>
    </footer>

    <script>
        function displayResult() {
            const regNo = document.getElementById("regno").value;
            const resultTable = document.getElementById("resultTable");
            const resultBody = document.getElementById("resultBody");
            const notice = document.getElementById("notice");
            const downloadBtn = document.getElementById("downloadBtn");

            // Clear previous results
            resultBody.innerHTML = "";
            resultTable.style.display = "none";
            notice.style.display = "block";
            downloadBtn.style.display = "none";

            // Extract the numeric part after the last '/' (e.g., "001" from "DHIA/2025/001")
            const numberPart = regNo.split('/').pop();
            const isThreeDigit = /^\d{3}$/.test(numberPart);

            if (regNo && isThreeDigit) {
                // Redirect to result_display.html with the registration number as a query parameter
                window.location.href = `result_display.html?regno=${encodeURIComponent(regNo)}`;
            } else if (regNo) {
                // Simulate result data for other registration numbers
                const sampleResults = [
                    { examType: "Degree - Arabic Literature", semester: "III", subject: "Arabic Literature", marks: "85", grade: "A" },
                    { examType: "Secondary", year: "5th", subject: "Islamic Studies", marks: "78", grade: "B+" },
                    { examType: "Senior Secondary", year: "7th", subject: "General Knowledge", marks: "90", grade: "A+" }
                ];

                resultTable.style.display = "table";
                notice.style.display = "none";
                downloadBtn.style.display = "inline-block";

                sampleResults.forEach(result => {
                    const row = document.createElement("tr");
                    row.innerHTML = `
                        <td>${result.examType || result.year}</td>
                        <td>${result.semester || result.year || "N/A"}</td>
                        <td>${result.subject}</td>
                        <td>${result.marks}</td>
                        <td>${result.grade}</td>
                    `;
                    resultBody.appendChild(row);
                });
            } else {
                alert("Please enter a valid Registration Number.");
            }
        }

        function downloadResults() {
            // Check if jsPDF is properly loaded
            if (typeof window.jspdf === 'undefined') {
                alert("PDF generation library not loaded properly. Please try again later.");
                return;
            }

            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                const regNo = document.getElementById("regno").value;
                const resultBody = document.getElementById("resultBody");

                // Add header with improved styling
                doc.setFontSize(22);
                doc.setTextColor(26, 35, 126); // primary color
                doc.text("Examination Result", 105, 20, { align: "center" });
                
                doc.setFontSize(14);
                doc.setTextColor(40, 53, 147); // secondary color
                doc.text("Official Student Record", 105, 30, { align: "center" });
                
                doc.setFontSize(12);
                doc.setTextColor(0, 0, 0); // black
                doc.text(`Registration Number: ${regNo}`, 20, 45);
                doc.text(`Date: ${new Date().toLocaleString("en-IN", { timeZone: "Asia/Kolkata" })}`, 20, 52);
                doc.text(`Student Name: Muhammad Safvan S`, 20, 59);

                // Add table with results
                const tableData = [["Exam Type", "Semester/Year", "Subject", "Marks", "Grade"]];
                const rows = resultBody.getElementsByTagName("tr");
                for (let i = 0; i < rows.length; i++) {
                    const cells = rows[i].getElementsByTagName("td");
                    tableData.push([
                        cells[0].innerText,
                        cells[1].innerText,
                        cells[2].innerText,
                        cells[3].innerText,
                        cells[4].innerText
                    ]);
                }

                // Calculate total marks and average
                let totalMarks = 0;
                let count = 0;
                for (let i = 1; i < tableData.length; i++) {
                    totalMarks += parseInt(tableData[i][3]);
                    count++;
                }
                const averageMarks = totalMarks / count;

                // Add the table
                doc.autoTable({
                    head: [tableData[0]],
                    body: tableData.slice(1),
                    startY: 70,
                    theme: 'grid',
                    styles: { 
                        halign: 'center',
                        fontSize: 11,
                        cellPadding: 5
                    },
                    headStyles: { 
                        fillColor: [40, 53, 147],
                        textColor: [255, 255, 255],
                        fontStyle: 'bold'
                    },
                    alternateRowStyles: {
                        fillColor: [245, 247, 255]
                    }
                });

                // Add summary
                const finalY = doc.previousAutoTable.finalY + 15;
                doc.setFontSize(12);
                doc.text(`Total Marks: ${totalMarks}`, 20, finalY);
                doc.text(`Average Score: ${averageMarks.toFixed(2)}`, 20, finalY + 7);
                
                // Add signature section
                doc.text("Examination Controller", 40, finalY + 30, { align: "center" });
                doc.line(20, finalY + 25, 60, finalY + 25); // Signature line
                
                doc.text("Principal", 160, finalY + 30, { align: "center" });
                doc.line(140, finalY + 25, 180, finalY + 25); // Signature line

                // Add footer
                doc.setFontSize(10);
                doc.setTextColor(100, 100, 100); // gray
                doc.text("© 2025 Examination Board. All rights reserved.", 105, 280, { align: "center" });
                doc.text("This is a computer-generated document and does not require a physical signature.", 105, 287, { align: "center" });

                // Download the PDF
                doc.save(`result_${regNo.replace(/\//g, '_')}.pdf`);
            } catch (error) {
                console.error("Error generating PDF:", error);
                alert("An error occurred while generating the PDF. Please try again.");
            }
        }
    </script>
</body>
</html>
